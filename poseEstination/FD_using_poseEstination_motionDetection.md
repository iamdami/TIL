## Review
[original article](https://neuralet.com/article/building-automatic-fall-detection-systems-using-computer-vision)  

- 장면에서 우리가 fall이라고 정의하려면 몸 부분의 위치가 갑자기 바뀌던가 해야 함  
  예를 들어 서 있는 자세(세로)에서 누워있는(가로) 자세로 바뀌던가!
  그러므로 포즈 예측은 몸 부분을 트랙킹하고 예측하고, 그 변화들을 쓰러짐을 탐지하는데 사용하기에 유용한 기술임

- 자동적인 쓰러짐 탐지를 위해 정확한 포즈 예측 모델 고르기  
   AlphaPose, OpenPifPaf, OpenPose 이것들이 젤 유명한데, 얘네는 AlphaPose, OpenPifPaf를 몇 가지 솔루션에 사용했다고 함
  얘네가 실험한 것에 기반해서 결국 AlphaPose를 이 연구에서 몸 스칼레톤 추출하는 데 사용하기로 함
  이 모델을 선택한 이유는 여러 다른 이유들이 있는데, 이 모델의 높은 속도와, 높은 정확도, 텐서RT 비전을 사용할 수 있음 등임

- 포즈 예측 모델 사용해 쓰러짐 탐지하는 방법  
  포즈 예측 모델은 입력 영상의 각 프레임마다 몸의 관절(머리, 어깨, 무릎, 엉덩이 등)들을 탐지하고 지역화할 수 있음
  그래서 이 능력으로 어떻게 쓰러짐을 탐지하냐면: 우리는 쓰러짐보다 안정적인 몸 포인트들을 참조해야 함
  백본은 가장 변화가 없는 단단한 부분 중 하나임
  어떠한 상황에서의 앵글과 움직임 걷는 것과 같은.
  또한, 쓰러짐이 발생하는 동안 백본의 움직임 파라미터는 빠르게 변함
  포즈 예측을 사용해 쓰러짐을 탐지하려면 다음의 과정을 따라야 함:
  목과 엉덩이 관절 사이에 트렁크 라인이라고 불리는 수직 선을 연결함
  그리고 상대적인 인터벌 동안 이 트렁크라인의 변화를 추적함
  만약 변화가 두 인터벌에서 스탠다드 스레시홀드를 넘기면 이를 쓰러짐으로 판단함

- 포즈 예측 기반 쓰러짐 탐지의 장단점  
장점
1) 모델을 학습할 필요도 없고, 수많은 레이블된 데이터를 모을 필요도 없음
  사전 학습된 오픈 소스 모델을 우리의 유스케이스에 적합하게 룰을 커스텀 정의해 이 엔진의 코어로 사용함
2) 게다가 실시간 처리나 엣지 디바이스와의 상호작용성도 장점임

단점
1) 포즈 예측기가 모든 환경과 상황에서 몸의 키포인트를 탐지할 수는 없다는 걸 알지만, 
  이 솔루션에서는 높은 recall이 필요함
  쓰러짐이 일어날 때마다 탐지해야 함
  그러나 이 일에 포즈 예측기만으로 신뢰할 수는 없음
  카메라 앵글과 환경적 상황에 따라 몸의 관절(키포인트)과 트렁크라인을 탐지하는데 실패할 수 있음
2) 이 방식의 다른 약점은 우리 모델의 2D 예측 때문임
  우리는 2D 포즈 예측을 사용하기 때문에 카메라 뷰 벡터와 병렬적으로 움직임이 나타나는 것과 같은 앵글에서 트렁크라인이 변하는 일이 일어남
  이런 블라인드 스팟까지 커버할 수 있는 보다 더 정교한 접근법이 필요함

- 어떻게 이 포즈 예측기를 향상시킬 수 있냐?  
  많은 포즈 예측 모델은 보통 서 있는 것과 같이 평범한 포지션의 사람들 이미지를 담고 있는 공공데이터를 이용해 학습되어짐
  높은 정확도를 가진 몸 키포인트 탐지를 위한 포즈 예측 모델을 향상시키려면, 사람들이 누워있거나 쓰러졌을 때의 상황을 담은 학습 셋이 필요함
  그 후에 이 새로운 데이터셋을 이런 상황에서 높은 정확도로 사용함으로서 튜닝함

- 움직임 탐지에 기반한 쓰러짐 탐지  
  이 알고리즘은 포즈 예측 모델과 따로 가져가야함. 그래야 이 약점들을 커버할 수 있음
  또한 모션 탐지(옵티컬 플로우) 알고리즘을 쓰러짐 탐지하는 데에 이전 모델에 보충하는 느낌으로 사용하기로 함
  최종 시스템은 가장 높은 정확도와 recall에 도달하기 위해 포즈 예측과 움직임 탐지 시스템 모두를 사용함
  
- 움직임 탐지와 포즈 예측을 따로 가져가는 이유?  
  움직임 탐지 혹은 옵티컬 플로우 알고리즘은 이미 opencv와 같은 컴퓨터 비전 라이브러리에서 사용 가능함
  얘네는 사용하기 쉽고 모델을 학습할 필요도 없고, 많은 데이터셋을 모을 필요도 없음
  현대의 옵티컬 플로우 기술은 움직임을 더 잘 탐지하기 위해 학습과 딥러닝을 이용함
  움직임 탐지 메소드에서는 학습이 필요없음: 이 알고리즘은 2개나 혹은 더 많은 연이은 프레임의 연관된 픽셀들을 비교할 뿐임
  이 메소드의 단순함은 환경에서의 변화를 더 독립적으로 만듦
  움직임 탐지는 포즈 예측과 완전히 비교되는 구별되는 접근법을 가짐
  그렇기 때문에 움직임 탐지 기반의 쓰러짐 탐지와 포즈 예측 기반의 쓰러짐 탐지는 나란히 가져갈 수 있음

- 움직임 탐지를 이용해 쓰러짐 탐지하는 법  
  트렁크 라인에 대해 얘기했던 것에 기반해, 우리는 이 부분을 우리의 ROI라고 할 수 있고, 이 트렁크라인의 쓰러짐 탐지하는 움직임을 추적할 수 있음
  이를 통해 원하는 몸 부분들을 식별하고 그것들의 변화를 추적하는 데에 우리의 움직임 탐지 알고리즘을 feed하는 데에 객체 탐지기를 사용할 수 있음
  우리가 보통적이지 않고 갑작스런 백본 포지션의 변화를 찾을 수 있다면, 이를 쓰러짐으로 판단할 것임
  이미지와 움직임 탐지 알고리즘을 위한 ROI를 먹인 후에, 그것은 그 영역 안의 움직임에 대해 방향(앵글)과 속도(세기)를 제공함
  우리는 이 파라미터를 갑작스런 변화가 일어나는 것 혹은 아닌 것에 대해 결정한 파라미터들과 비교하게 됨

- 쓰러짐 탐지하는 데의 움직임 탐지의 단점  
  포즈 예측과 비슷하게, 우리의 예측에 몇 가지 움직임을 탐지하는 데 실패할 수 있는 2D 메소드를 사용함
  게다가 옵티컬 플로우 메소드는 이미지의 불빛 변화와 같은 노이즈에 예민함
  -> 예측 실패를 이끔

- 두 가지 장점을 모두 가진 이 시스템을 추천함  

- lying down이랑 falling을 어케 구별하지?  
   -> 움직임의 속도와 트렁크라인의 변화가 주된 차이점!
   - 이 두가지 액션을 구별하기 위해 트렁크 라인 앵글의 변화하는 속도를 이용해 움직임을 filter함
   - 침대나 쇼파등을 식별하기위해 객체 탐지기를 사용할 수도 있음
